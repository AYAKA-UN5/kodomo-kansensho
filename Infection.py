import streamlit as st

# タイトル
st.title("子どもの感染症推測アプリ")
st.write("※受診を迷った際はこども急病相談(#8000)に相談してみましょう！")

# ユーザー入力
taion = st.multiselect('■体温', 
 ['微熱', '発熱（37-38℃）', '発熱（38℃以上）','該当なし'], 
  placeholder="選択してください")

hassin = st.multiselect('■発疹', 
  ['水泡（口内）', '水泡（手の平・足の裏）', '赤く細かい湿疹（全身）','該当なし'], 
  placeholder="選択してください")

me = st.multiselect('■目の症状', 
  ['目の充血', '目やに', '目の痛み・かゆみ','まぶたの腫れ','該当なし'], 
  placeholder="選択してください")

itami = st.multiselect('■痛み・腫れ', 
  ['頭痛', '耳の痛み・違和感', 'リンパ節の腫れ・痛み',
  '耳の下・あごの下・舌の下の腫れ','筋肉痛','関節痛',
  '口腔内の痛み','喉の腫れ・痛み','舌に赤いブツブツ（いちご舌）','該当なし'], 
  placeholder="選択してください")

kaze = st.multiselect('■風邪症状', 
  ['風邪の諸症状', '食欲不振', '倦怠感','咳','鼻水','該当なし'], 
  placeholder="選択してください")

ityou = st.multiselect('■胃腸症状', 
  ['嘔吐', '下痢','腹痛','該当なし'], 
  placeholder="選択してください")

# 症状パターンの辞書を定義
illnesses = {
    "溶連菌感染症": {
        "症状": {
            "taion": ['発熱（38℃以上）'],
            "hassin": ['赤く細かい湿疹（全身）'],
            "me": ['該当なし'],
            "itami": ['喉の腫れ・痛み','舌に赤いブツブツ（いちご舌）'],
            "kaze": ['該当なし'],
            "ityou": ['該当なし']
        },
        "詳細": "溶連菌感染症は、A群溶血性レンサ球菌による感染症です。発熱、喉の痛み、全身の赤い発疹が主な症状です。抗生物質による治療が必要です。",
        "治療法": "ペニシリン系抗生物質やアモキシシリンなどの抗生物質が一般的に用いられます。"
    },
    "ヒトメタニューモウイルス感染症": {
        "症状": {
            "taion": ['微熱'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['喉の腫れ・痛み'],
            "kaze": ['咳','鼻水'],
            "ityou": ['該当なし']
        },
        "詳細": "ヒトメタニューモウイルスは、風邪に似た症状を引き起こすウイルスです。軽度の発熱や喉の痛みが見られます。通常、特別な治療は不要で、対症療法が行われます。",
        "治療法": "休養と水分補給が主な治療法です。必要に応じて、咳や鼻水の症状を緩和する薬が使用されることがあります。"
    },
    "流行性耳下腺炎（おたふくかぜ）": {
        "症状": {
            "taion": ['該当なし'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['耳の痛み・違和感','耳の下・あごの下・舌の下の腫れ','筋肉痛'],
            "kaze": ['風邪の諸症状','食欲不振'],
            "ityou": ['該当なし']
        },
        "詳細": "おたふくかぜは、ムンプスウイルスによる感染症で、耳下腺（唾液腺）の腫れが特徴です。主に子供に見られますが、成人も感染することがあります。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。休養と水分補給が重要です。"
    },
    "百日咳": {
        "症状": {
            "taion": ['該当なし'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['該当なし'],
            "kaze": ['咳'],
            "ityou": ['該当なし']
        },
        "詳細": "百日咳は、ボルデテラ・パータシス菌による感染症で、激しい咳発作が特徴です。特に乳幼児に重症化することがあります。",
        "治療法": "抗生物質（マクロライド系など）が使用されます。早期診断と治療が重要です。"
    },
    "手足口病": {
        "症状": {
            "taion": ['微熱'],
            "hassin": ['水泡（口内）','水泡（手の平・足の裏）'],
            "me": ['該当なし'],
            "itami": ['口腔内の痛み'],
            "kaze": ['食欲不振'],
            "ityou": ['該当なし']
        },
        "詳細": "手足口病は、エンテロウイルス属のウイルスによる感染症で、口内や手足に水疱が現れます。主に幼児に発症します。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。通常は自然治癒しますが、重症化することもあります。"
    },
    "ヘルパンギーナ": {
        "症状": {
            "taion": ['発熱（37-38℃）'],
            "hassin": ['水泡（口内）'],
            "me": ['該当なし'],
            "itami": ['口腔内の痛み'],
            "kaze": ['食欲不振','倦怠感'],
            "ityou": ['該当なし']
        },
        "詳細": "ヘルパンギーナは、コクサッキーウイルスによる夏季に多い感染症で、口内に痛みを伴う水疱が現れます。急な発熱が特徴です。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。休養と水分補給が重要です。"
    },
    "咽頭結膜熱（プール熱）": {
        "症状": {
            "taion": ['発熱（38℃以上）'],
            "hassin": ['該当なし'],
            "me": ['目の充血','目やに','目の痛み・かゆみ'],
            "itami": ['頭痛', 'リンパ節の腫れ・痛み','喉の腫れ・痛み'],
            "kaze": ['該当なし'],
            "ityou": ['該当なし']
        },
        "詳細": "咽頭結膜熱は、アデノウイルスによる感染症で、高熱、喉の痛み、目の充血が特徴です。主に夏季に発症しやすいです。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。休養と水分補給が重要です。"
    },
    "流行性角結膜炎（はやり目）": {
        "症状": {
            "taion": ['該当なし'],
            "hassin": ['該当なし'],
            "me": ['目の充血','目やに','まぶたの腫れ'],
            "itami": ['リンパ節の腫れ・痛み'],
            "kaze": ['該当なし'],
            "ityou": ['該当なし']
        },
        "詳細": "流行性角結膜炎は、アデノウイルスによる目の感染症で、目の充血、目やに、まぶたの腫れが特徴です。非常に伝染力が強いです。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。通常は自然治癒します。"
    },
    "マイコプラズマ感染症": {
        "症状": {
            "taion": ['微熱'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['頭痛'],
            "kaze": ['倦怠感','咳'],
            "ityou": ['該当なし']
        },
        "詳細": "マイコプラズマ感染症は、マイコプラズマ・ニューモニエ菌による感染症で、軽度の発熱や咳が特徴です。通常は軽症ですが、長引くことがあります。",
        "治療法": "マクロライド系やテトラサイクリン系の抗生物質が使用されます。"
    },
    "RSウイルス感染症": {
        "症状": {
            "taion": ['微熱'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['リンパ節の腫れ・痛み'],
            "kaze": ['咳','鼻水'],
            "ityou": ['該当なし']
        },
        "詳細": "RSウイルスは、乳幼児に重症の呼吸器感染症を引き起こすことがあります。微熱や咳、鼻水が主な症状です。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。重症の場合は入院が必要です。"
    },
    "インフルエンザ": {
        "症状": {
            "taion": ['発熱（38℃以上）'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['頭痛','筋肉痛','関節痛','喉の腫れ・痛み'],
            "kaze": ['倦怠感','咳','鼻水'],
            "ityou": ['該当なし']
        },
        "詳細": "インフルエンザは、インフルエンザウイルスによる感染症で、急な高熱、頭痛、筋肉痛、関節痛が特徴です。通常、冬季に流行します。",
        "治療法": "抗ウイルス薬（オセルタミビル、ザナミビルなど）が使用されます。早期の治療が重要です。"
    },
    "ウイルス性胃腸炎（ノロウイルス感染症）": {
        "症状": {
            "taion": ['該当なし'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['該当なし'],
            "kaze": ['該当なし'],
            "ityou": ['嘔吐','下痢','腹痛']
        },
        "詳細": "ノロウイルス感染症は、急性胃腸炎の一種で、嘔吐、下痢、腹痛が主な症状です。非常に伝染力が強いです。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。水分補給が重要です。"
    },
    "アデノウイルス感染症": {
        "症状": {
            "taion": ['発熱（37-38℃）', '発熱（38℃以上）'],
            "hassin": ['該当なし'],
            "me": ['目の充血', '目やに'],
            "itami": ['喉の腫れ・痛み'],
            "kaze": ['風邪の諸症状'],
            "ityou": ['下痢']
        },
        "詳細": "アデノウイルスは、咽頭結膜熱や胃腸炎など、さまざまな症状を引き起こすウイルスです。発熱、目の充血、喉の痛みが特徴です。",
        "治療法": "特効薬はなく、症状に応じた対症療法が行われます。通常は自然治癒します。"
    },
    "溶血性レンサ球菌咽頭炎": {
        "症状": {
            "taion": ['発熱（38℃以上）'],
            "hassin": ['該当なし'],
            "me": ['該当なし'],
            "itami": ['喉の腫れ・痛み', '頭痛'],
            "kaze": ['風邪の諸症状'],
            "ityou": ['該当なし']
        },
        "詳細": "溶血性レンサ球菌咽頭炎は、A群溶血性レンサ球菌による喉の感染症です。急な発熱、喉の痛み、頭痛が特徴です。",
        "治療法": "ペニシリン系抗生物質やアモキシシリンなどの抗生物質が一般的に用いられます。"
    }
}

# ユーザーの選択を辞書に変換
user_selection = {
    "taion": taion,
    "hassin": hassin,
    "me": me,
    "itami": itami,
    "kaze": kaze,
    "ityou": ityou
}

# 症状の一致をチェックする関数
def check_symptoms(user_selection, illness_symptoms):
    for key in illness_symptoms:
        if set(user_selection[key]) & set(illness_symptoms[key]):
            continue
        else:
            return False
    return True

# 一致する感染症を見つける
matched_illnesses = [illness for illness in illnesses if check_symptoms(user_selection, illnesses[illness]["症状"])]

# 結果を表示
if matched_illnesses:
    for illness in matched_illnesses:
        st.write(f"↓↓　推測される感染症　↓↓")
        st.write(f"### {illness}")
        st.write(f"**詳細**: {illnesses[illness]['詳細']}")
        st.write(f"**治療法**: {illnesses[illness]['治療法']}")
else:
    st.write("一致する感染症が見つかりませんでした。")